# SoulEater
인하대학교 컴퓨터공학과 2021-1 게임프로그래밍  프로젝트  
INHA Univ. 2021-1 Game Programming Class Project

2인 팀으로 개발되었으며, 팀장을 맡아 전체적인 프로젝트 관리를 겸한 본인의 개발 영역은

- 입력 처리 및 애니메이션
- 물리 처리
- UI/UX 및 기능 구현(미니맵 제외)
- 대부분의 캐릭터 스킬 구현
- 드랍 아이템 구현

등이 있다.

## [Demo video]

[![Watch the video](https://images.velog.io/images/cedongne/post/77b1bfa0-8064-4729-b82d-191ce4300848/SoulEater%20Thumbnail.png)](https://youtu.be/NiL4u9SOjL0)

- # 게임 소개
  로그라이크 장르의 3D 핵앤슬래시 게임으로, 게임을 플레이할 때마다 캐릭터가 플레이하는 맵, 나오는 몬스터, 스킬 등의 다양한 요소들이 랜덤하게 등장하며 매판 새로운 게임을 하는 신선한 느낌을 가져다준다. 출현하는 몬스터를 잡으면 해당 몬스터의 영혼이 일정 확률로 드랍되고, 플레이어가 영혼을 흡수하여 자신의 능력으로 만들어 전투에 활용할 수 있다.
  
- # 시점 및 조작 방법
  
    - **시점 및 컨트롤** 
    
      스타일리시한 전투 방식을 위해 쿼터 뷰 시점을 차용한다. 마우스 커서로 공격 방향을 지정하며, 키보드로 이동 / 공격 / 대시 / 스킬 사용 / 상호작용 등의 조작을 할 수 있다.
    
    - **마우스 커서 공격 방향 지정**
      
      마우스 커서로 공격 방향을 지정하는 방식은 RayCast를 이용하였고, 사선으로 화면을 내려보는 시점 방식을 고려하여 스크린 좌표계로 이동하여 마우스 방향을 올바르게 따라갈 수 있도록 처리해주었다. 
      
      Ray가 진행하는 방향에 스킬 이펙트나 몬스터 오브젝트 등 다양한 장애물이 존재할 때 기대와 다른 방향으로 투사체가 발사되기도 하였는데, 해당 오브젝트들을 Ignore Raycast layer에 놓음으로써 문제를 해결하였다. 결과적으로 화면에서 원하는 지점을 찍으면 해당 방향을 플레이어가 바라보는 LookMouseCursor 함수를 구현하여 다양한 공격 모션에 활용하였다.
    
    - **기본공격**
      
      LookMouseCursor 함수로 원하는 방향을 향해 플레이어가 회전하면 해당 방향으로 Velocity를 주어 투사체를 발사하였다.
  
    - **대시**
   
      대시를 위한 애니메이션을 실행시킴과 동시에 플레이어의 속도를 일시적으로 빠르게 조절하여 구현하였다. 동시에 무한정 대시를 사용할 수 없도록 isDodgeReady 플래그를 설정하고 Time.deltaTime을 연산하여 일정한 쿨타임을 두고 대시를 사용할 수 있게 설정하였다.

    - **스킬 사용**
 
      보유 가능한 세 개의 스킬을 숫자키 1, 2, 3번으로 사용할 수 있게 하였고, 기본공격이나 대시와 마찬가지로 다른 행동과 동시에 실행할 수 없도록 플래그를 설정해주었다. 보유한 스킬이 액티브 스킬일 경우 개별 쿨타임을 설정해주었고, 이 쿨타임은 스킬마다 각자의 쿨타임 변수를 만들어 따로 관리가 가능하도록 설계하였다. 
      
      <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149352843-97912d9a-cf5c-4e33-8ccf-b2bc42b9beac.png"></p>
      
      이러한 쿨타임 관리는 코루틴 함수를 이용해 여러 스킬의 쿨타임이 병렬적으로 처리가 가능하도록 해주었고, Filled image type에서 Radial 360 방식을 적용해 원형으로 쿨타임 표현이 가능하도록 함과 동시에 쿨타임 동안 재사용해도 다시 게이지가 돌지 않도록 처리해주었다.
      
      또한, 각 스킬 초상화 위에 존재하는 번호판의 색깔을 액티브/패시브 스킬에 따라 다르게 하여 어떤 스킬이 사용 가능한 스킬인지 구분되도록 디자인해 주었다.
      
    - **상호작용**
    
      몬스터를 처치하고 나온 영혼을 획득하여 자신의 스킬로 만드는 상호작용을 구현하였다.
      
      <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149353270-cab83d81-ad10-482a-8fcc-06b0cc33e4df.png"></p>
      
      이때 똑같은 스킬을 두 개 가지지 않도록 가지고 있는 영혼 리스트를 만들어 현재 플레이어가 습득 가능한 범위에 있는 영혼이 플레이어가 보유 중인 영혼인지 판단하여 이미 존재하고 있다면 중복으로 획득할 수 없도록 처리해주었다.
            
      <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149353939-bbebcd77-ab08-4f06-89d6-4c0e68127afa.png"></p>
      
      이미 세 개의 영혼을 가지고 있을 때 새로운 영혼을 습득하려 한다면 자신이 가지고 있는 다른 영혼과 바꿀 것인지, 혹은 말 것인지 선택할 수 있도록 처리해주었고, 이동키로 어떤 스킬과 교환할 것인지 선택이 가능하도록 설계해주었다. 이때 현재 보유 중인 패시브 스킬을 변경하려 한다면 적용된 패시브 스킬의 인스턴스 등을 모두 해제하고 새롭게 습득할 스킬을 적용해주었다.
      
- # UI
  - **HUD**
  
    에셋 스토어의 [GUI Parts](https://assetstore.unity.com/packages/2d/gui/icons/gui-parts-159068) 에셋을 이용 및 수정하여 아래의 Head-up display를 제작해 인게임에 적용하였고, UI component 중 Slider를 이용해 HP bar를 구현하였다. HUD는 FHD(1920x1080)와 QHD(2560x1440)에서 호환이 가능하도록 구현하였다.
    
    <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149356222-70ba4a7b-cfce-4001-86f0-fb0d06bd5e43.png"></p>

    
    UI Manager를 이용해 플레이어의 체력을 실시간으로 관찰하고 즉각적으로 감소폭을 확인할 수 있도록 처리해 주었다.
    
  - **미니맵**
  
    <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149355002-d28a97ef-f1e0-4777-a6b3-2df40218dba6.png"></p>
    
    화면 좌측 하단에 현재 플레이어가 위치한 맵을 직교로 투영하는 또다른 카메라를 배치하여 맵 구조와 플레이어/몬스터/포탈의 위치를 파악할 수 있는 미니맵을 구현하였다.

  - **몬스터 HP bar**
  
    <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149355040-20ec8f19-86ce-473a-9ed1-ad559afed735.png"></p>
    
    필드에 존재하는 모든 몬스터에게 플레이어와 같이 남은 체력을 확인할 수 있는 HP bar를 할당해주었다. 현재 몬스터의 월드 좌표계 위치를 실시간으로 불러와 스크린 좌표계로 변환한 위치에 HP bar를 위치시키고 현재 체력에 비례하여 Slider의 게이지를 변경해주었다.

- # 캐릭터 기본 정보

  플레이어가 가지는 능력치는 총 6종류이며, 각각의 기본값은 다음과 같다.
  
  |  능력치                      | 수치  |
  | :-------------------------  | :---: |
  | `체력`                       | 100  |
  | `공격력` 		  	            | 10   |
  | `이동속도` `(최대 10)`       | 5	   |
  | `공격속도` `(초당 공격 횟수)` | 2    |
  | `쿨타임 감소` `(최대 60%)`   | 0     |

  기본공격은 특별한 힘으로 전방에 투사체를 발사한다. 적중한 몬스터를 기준으로 작은 범위에 대미지를 준다. 영혼은 3개까지 소지가 가능하며, 영혼을 최대로 소지하고 있을 때 이미 가지고 있는 영혼을 새로운 영혼으로 변경하는 것이 가능하다.
  
- # 스킬
  몬스터 처치 시 일정 확률로 그 몬스터의 영혼이 나온다. 각 영혼을 획득할 시 플레이어에게 몬스터의 특징에 어울리는 스킬을 부여한다. 스킬 타입에는 `패시브`, `액티브`, `투사체`가 있으며, 몬스터들의 영혼이 제공하는 스킬은 다음과 같다. 
  
  | 등급 | 마물 종류       | 스킬 효과                                    |
  |:----:|:--------------:|:---------------------------------------------|
  | 일반 | 그런트          | 커다란 바위를 던져 범위에 높은 대미지          |
  | 일반 | 고슴도치        | 캐릭터 주변 범위로 들어오는 몬스터에 대미지     |
  | 일반 | 미믹            | 보유 중인 스킬 쿨타임 50% 감소                |
  | 일반 | 검정 악어       | 영구적으로 공격력 + 공격속도 증가              |
  | 일반 | 초록 악어       | 주변에 독 장판을 생성해 지속 대미지 + 둔화      |
  | 일반 | 드레이크        | 세 갈래로 나가는 파이어 볼 발사                |
  | `희귀` | 파이어 드래곤 | 지정한 위치로 메테오 발사                      |
  | `희귀` | 오크          | 전방을 강하게 내리쳐 지진 발생 + 넓은 범위 둔화 |
  
  <p align="center"><img src = "https://user-images.githubusercontent.com/57585303/149355089-24986c27-c42e-4587-a469-1f46cfa15ce2.png"></p>

  위 표의 왼쪽부터 각 몬스터의 영혼을 나열한 모습이다. 이후 아래는 게임에서 사용 가능한 스킬의 종류이다. 일반 몬스터의 영혼은 30%, 미믹은 20% 확률로 드랍되며, 네임드 몬스터의 영혼은 30%
확률로 드랍된다.
  - **그런트**
    
    ![image](https://user-images.githubusercontent.com/57585303/149383476-d446f326-5468-42f8-9113-12d8f24d2b2f.png)

    |스탯      | 내용              | 스탯        | 내용 |
    |:--------:|:-----------------:|:----------:|:----:|
    | `몬스터` | 그런트             | `스킬 타입` |투사체|
    | `대미지` | 투사체 20, 폭발 15 | `쿨타임`    |8초   |
